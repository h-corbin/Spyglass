
<div *ngIf="!noGoals"> 
  <div class="container text-center">
    <h1>Your Goals</h1>
  </div>
  
  <div class="container text-center">
    <div class="row flexGoals">
      <div class="col-4 d-flex align-items-stretch" *ngFor="let goal of goalList">
        <div class="card">
          <div class="card-body d-flex flex-column">
            <h2 class="card-title text-center">{{ goal.name }}</h2>
            <img
              src="{{ goal.picture }}"
              class="card-img-top"
            />
            <ul class="list-group list-group-flush">
              <li class="list-group-item">{{ goal.description }}</li>
              <li class="list-group-item">
                target date: {{ goal.targetDate }}
              </li>
              <li class="list-group-item">
                target amount: {{ goal.targetAmount | currency}}
              </li>
              <li class="list-group-item">
                  current amount: {{ goal.currentAmount | currency }}
              </li>
              <li class="list-group-item">
                  progress: {{ goal.progress | number :'1.0-2' }}%
                  <mat-progress-bar mode="determinate" value="{{ goal.progress }}"></mat-progress-bar>
              </li>
              <li class="list-group-item" *ngIf="goal.displayPartners">
                partners: {{ goal.users }}
              </li>
              
            </ul>
            <br />
            <div class="d-grid gap-2 mt-auto">
              <button
                class="btn btn-success"
                type="button"
                (click)="open(updateModal, goal)"
              >
                Edit
              </button>
              <button
                class="btn btn-primary"
                type="button"
                (click)="open(partnerModal, goal)"
              >
                Add a Partner
              </button>
              <button
                class="btn btn-danger"
                type="button"
                (click)="delete(goal)"
              >
                Delete this goal
              </button>
            </div>
          </div>
        </div> 
        <br />
      </div>
    </div>
  </div>
</div>



<ng-template #partnerModal let-modal>
  <div class="modal-header">
    <h2 class="modal-title" id="modal-basic-title">Invite a Partner</h2>
    <button type="button" class="btn-close" (click)="modal.dismiss('Cross click')"></button>
  </div>
  <div class="modal-body">
    <div class="message">Add another Spyglass user to this goal. Your goal will also show up in their list of goals. As your partner, they will be able to edit and contribute savings toward this goal.</div>
    <div class="alert alert-warning" *ngIf='updateGoalFailed'>Unable to add this user.</div>
    <div>
      <label for="partner">Partner's username: </label>
      <input id="partner" class="form-control" name="partner" type="text" [(ngModel)]=newPartner>
    </div>
  </div>
  <div class="modal-footer">
      <button type="button" class="btn btn-success" (click)="invite(editGoal, newPartner)">Invite</button>
  </div>
</ng-template>



<ng-template #updateModal let-modal>
  <div class="modal-header">
      <h2 class="modal-title" id="modal-basic-title">Edit this Goal</h2>
      <button type="button" class="btn-close" aria-label="Close" (click)="modal.dismiss('Cross click')"></button>
  </div>
  <div class="modal-body">
    <form class="edit-form">
      <div class="alert alert-warning" *ngIf='updateGoalFailed'>Error</div>
      <div class="mb-3">
          <label for="name">Goal Name: </label>
          <input id="name" class="form-control" name="name" type="text" [(ngModel)]=editGoal.name>
      </div>
      <div class="mb-3">
          <label for="description">Description: </label>
          <input id="description" class="form-control" name="description" type="text" [(ngModel)]=editGoal.description>
      </div>

      <div class="amounts">
        <div class="mb-3 inputAmount">
          <label for="target">Target Amount: </label>
          <div>
            <span class="selecAmmount">
              <input id="target" class="form-control dollar" name="target" type="text" [(ngModel)]=editGoal.targetAmount>
            </span>
          </div>
        </div>
        <div class="mb-3 inputAmount">
            <label for="current">Current Amount: </label>
            <div>
              <span class="selecAmmount">
                <input id="current" class="form-control dollar"  name="current" type="text" [(ngModel)]=editGoal.currentAmount>
              </span>
            </div>
        </div>
      </div>

      <div class="mb-3">
          <label for="date">Target Date: </label>
          <input type="date" id="date" class="form-control" name="date" [(ngModel)]=editGoal.targetDate>
      </div>
    </form>
  </div>
  <div class="modal-footer">
      <button type="button" class="btn btn-success" (click)="update(editGoal)">Save</button>
  </div>
</ng-template>